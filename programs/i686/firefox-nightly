#!/bin/sh

mkdir /opt/firefox-nightly
cd /opt/firefox-nightly

echo "#!/bin/sh
rm -R -f /opt/firefox-nightly /usr/share/applications/firefox-nightly.desktop /usr/local/bin/firefox-nightly" >> /opt/firefox-nightly/remove
chmod a+x /opt/firefox-nightly/remove

mkdir tmp;
cd ./tmp;
wget "https://download.mozilla.org/?product=firefox-nightly-latest&os=linux&lang=en-US" --trust-server-names
tar fx firefox-*.tar.bz2
cd ..
mv ./tmp/firefox/* ./
rm -R ./tmp

currentuser=$(who | awk '{print $1}')
chown -R $currentuser /opt/firefox-nightly

ln -s /opt/firefox-nightly/firefox /usr/local/bin/firefox-nightly

rm -R -f /usr/share/applications/firefox-nightly.desktop
echo "[Desktop Entry]
Name=Firefox Nightly
Comment=Web Browser
Exec=/opt/firefox-nightly/firefox %u
Terminal=false
Type=Application
Icon=/opt/firefox-nightly/browser/chrome/icons/default/default128.png
Categories=Network;WebBrowser;
MimeType=text/html;text/xml;application/xhtml+xml;application/xml;application/vnd.mozilla.xul+xml;application/rss+xml;application/rdf+xml;image/gif;image/jpeg;image/png;x-scheme-handler/http;x-scheme-handler/https;
StartupNotify=true
Actions=Private;

[Desktop Action Private]
Exec=/opt/firefox-nightly/firefox --private-window %u
Name=Open in private mode"  >> /usr/share/applications/firefox-nightly.desktop

echo "";
echo " Firefox Nightly has been installed! ";
echo "";
